"use strict";var Login=Login||{};Login.init=function(){this.apiUrl="http://localhost:3000/api",this.$main=$("main"),$(".register").on("click",this.register.bind(this)),$(".login").on("click",this.login.bind(this)),$(".logout").on("click",this.logout.bind(this)),this.$main.on("submit","form",this.handleForm),this.getToken()?this.loggedInState():this.loggedOutState()},Login.loggedInState=function(){$(".loggedIn").show(),$(".loggedOut").hide()},Login.loggedOutState=function(){$(".loggedIn").hide(),$(".loggedOut").show()},Login.register=function(t){t&&t.preventDefault(),console.log("register")},Login.login=function(t){t&&t.preventDefault(),console.log("login")},Login.logout=function(t){t.preventDefault(),this.loggedOutState(),this.removeToken()},Login.handleForm=function(t){t.preventDefault();var e=""+Login.apiUrl+$(this).attr("action"),o=$(this).attr("method"),n=$(this).serialize();return Login.ajaxRequest(e,o,n,function(t){t.token&&Login.setToken(t.token),Login.loggedInState()})},Login.ajaxRequest=function(t,e,o,n){return $.ajax({url:t,method:e,data:o,beforeSend:this.setRequestHeader.bind(this)}).done(n).fail(function(t){console.log(t)})},Login.setRequestHeader=function(t){return t.setRequestHeader("Authorization","Bearer "+this.getToken())},Login.setToken=function(t){return window.localStorage.setItem("token",t)},Login.getToken=function(){return window.localStorage.getItem("token")},Login.removeToken=function(){return window.localStorage.clear()},Login.clearModal=function(){$("#registerModal").modal("hide"),$("#loginModal").modal("hide")},$(Login.init.bind(Login));